<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>FESTIVAL ON MAP</title>
        <style type="text/css">
            #map_canvas {
                width: 800px;
                height: 600px;
            }
            #g{
                background-color: red;
                width: 800px;
                height: 600px;
            }
        </style>
        <script src="http://maps.google.com/maps/api/js?sensor=false" 
        type="text/javascript"></script> 
        <!--<script src="//code.jquery.com/jquery-1.10.2.js" type="text/javascript"></script> -->
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
        <script type="text/javascript" src="jqcloud-1.0.4.js"></script>

        <script type="text/javascript">
            $.getJSON("coordinates.json", initialize);

            function initialize(json) {
                var coordinates = new Array();
                coordinates = json.coordinates;
                var map_options = {
                    center: new google.maps.LatLng(coordinates[0].lat, coordinates[0].lng),
                    zoom: 5,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };

                var google_map = new google.maps.Map(document.getElementById("map_canvas"), map_options);

                var info_window = new google.maps.InfoWindow({
                    content: 'loading'
                });


                var t = [];
                var x = [];
                var y = [];
                var h = [];

                for (var j = 0; j < coordinates.length; j++) {

                    console.log(j);
                    t.push(coordinates[j].city);
                    x.push(coordinates[j].lat);
                    y.push(coordinates[j].lng);
                    h.push('<p><strong>Location Name 1</strong><br/>Address 1</p>');

                }
                console.log(t);
                var i = 0;
                for (item in t) {
                    var m = new google.maps.Marker({
                        map: google_map,
                        animation: google.maps.Animation.DROP,
                        title: t[i],
                        position: new google.maps.LatLng(x[i], y[i]),
                        html: h[i]
                    });

                    google.maps.event.addListener(m, 'click', function() {
                        info_window.setContent(this.html);
                        info_window.open(google_map, this);
                        // send GET to server for chosen festival
                    });
                    i++;
                }
            }
        </script>
        <script type="text/javascript">
            var myOptions = [];
            $.getJSON("genres.json", addItem);
            function addItem(json)
            {
                var genres = new Array();
                genres = json[0].genres;

                for (var i = 0; i < genres.length; i++) {
                    var genre = new Object;
                    genre = genres[i].genre;
                    console.log(genre);
                    myOptions.push(genre);
                    console.log(myOptions);
                }
                $.each(myOptions, function(i, el)
                {
                    $('#genres').append(new Option(el));
                });


            }
        </script>

        <script type="text/javascript">
            /*!
             * Create an array of word objects, each representing a word in the cloud
             */
            var word_array = [
                {text: "Lorem", weight: 15},
                {text: "Ipsum", weight: 9, link: "http://jquery.com/"},
                {text: "Dolor", weight: 6, html: {title: "I can haz any html attribute"}},
                {text: "Sit", weight: 7},
                {text: "Amet", weight: 5}
                // ...as many words as you want
            ];

            $(function() {
                // When DOM is ready, select the container element and call the jQCloud method, passing the array of words as the first argument.
                $("#example").jQCloud(word_array);
            });
        </script>
    </head>
    <body>
        <div id="map_canvas"></div>
        <div id="combo_div"><select id="genres"/>
        </div>
        <div id="g"></div>
    </body>
</html>